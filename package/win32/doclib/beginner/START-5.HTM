<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="ja">	<head>		<meta http-equiv="content-type" content="text/html;charset=Shift_JIS">		<meta lang="ja" name="keywords" content="HSP,Hot Soup Processor,HSPTV,HSP3,HSP3.2,ONION software,onitama,ホットスープ,プロセッサ,インタプリタ,言語,ＨＳＰ">		<meta name="generator" content="Adobe GoLive">		<title>HSP入門</title>		<link href="main.css" type="text/css" rel="stylesheet" media="all">	</head>	<body background="images/back6.gif" link="blue" leftmargin="0" marginheight="0" marginwidth="0" topmargin="0">		<div align="center">						<table width="800" border="0" cellspacing="0" cellpadding="0">				<tr>					<td align="left" valign="top" bgcolor="white" width="169">										<br>						<table width="150" border="0" cellspacing="0" cellpadding="0" height="354">							<tr height="30">								<td height="30" background="images/back_menuue.gif">									<p class="leftsubmenu"><a href="COVER.HTM">Start!</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-1.HTM">Step1</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-2.HTM">Step2</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-3.HTM">Step3</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-4.HTM">Step4</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu" style="color:#009999; font-weight:bold;">Step5</p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-6.HTM">Step6</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-7.HTM">Step7</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-8.HTM">Step8</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-9.HTM">Final</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="THANKS.HTM">Special thanks</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_menusita.gif">									<p class="leftsubmenu"><a href="START.HTM">Cover</a></p>								</td>							</tr>						</table>						<br>					</td>					<td align="left" valign="top" bgcolor="white">						<div class="contents">							<div class="section">								<h2 class="play">step5：スクリプトに旗を立てよう</h2>								<br>								<p>スクリプトは命令の集まりで、1行目から順番に実行されていくという ことはわかりましたよね。すべての行を実行すると、そのまま停止することも。 今度はそれだけではなく、プログラムの流れを制御する命令を覚えましょう。 こう書くと何だか難しそうですね。<br>									<br>									ここでスクリプトに旗を立ててみましょう。 ええーっ?? 旗って何ーー?? それはつまり、スクリプトの中の特定の行にしるしをつけることです。 登山家が山に登った時に、バスッと立ててくる、あれです。 たとえばこんなスクリプト、<br>									<br>								</p>								<table width="592" border="0" cellspacing="0" cellpadding="0">									<tr>										<td width="45">											<p><b>*hata1</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>cls</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata2</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>mes&quot;はーい、こんにちは&quot;</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata3</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>mes&quot;旗を立ててみるテストです&quot;</b></p>										</td>									</tr>								</table>								<p><br>									これには3つの旗が立っています。 そう、「*hata1」「*hata2」「*hata3」という行のことです。 「*(アスタリスク)」の後に英文字で名前を入れることで、好きな場所 に好きな名前をつけて旗を立てることができるのです。 ここでの約束事は、<br>									<br>								</p>								<img src="images/btn_extention.gif">								<div class="enroll">									<ol>										<li>命令と違って最初にTABを入れてはいけない																				<li>*の後に英文字(59文字以内)で名前をつける																				<li>同じ名前が2カ所以上あってはいけない																		</ol>								</div>								<p><br>									しかし、苦労して旗を立てたからと言って何かあるのでしょうか? という疑問が、おのずと沸いてくると思います。 上の例にあるスクリプトをF5で実行させると、<br>									<br>									<b>はーい、こんにちは<br>										旗を立ててみるテストです</b><br>									<br>									という、いままで習った通りに1行目から順番に命令を実行した結果が 出るだけです。せっかく立てた旗も無視されているようです。 では、今度は次のようにスクリプトを変更してみましょう。<br>									<br>								</p>								<table width="592" border="0" cellspacing="0" cellpadding="0">									<tr>										<td width="45">											<p><b>*hata1</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>cls<br>														goto *hata3</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata2</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>mes&quot;はーい、こんにちは&quot;</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata3</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>mes&quot;旗を立ててみるテストです&quot;</b></p>										</td>									</tr>								</table>								<p><br>									今度は3行目に「goto *hata3」という謎の命令が出てきました。 とりあえず何も考えないで実行してみましょう。<br>									<br>									<b>旗を立ててみるテストです</b><br>									<br>									という行しか出てこなくなりましたね。 これは、「goto」という命令がスクリプトの流れを変えたためです。 つまり、「goto」命令はパラメータで指定した名前の旗に実行の流れを 変えるはたらきがあるのです。ここで初めて、いままで立てた旗が役に 立つのです。1行目から実行されてきた命令は、3行目の「goto」命令に より、4,5行目を飛ばして、いきなり「*hata3」のある6行目に飛んで、 そこからまた実行されていったのです。<br>									<br>									このように旗を立てるのは、スクリプトの流れを別な場所に持っていき たい時に、その場所を指定するためのものなのです。 そしてこれは、HSPでは正式には「ラベル」と呼ばれています。これか らは旗という名前はやめて、ラベルと呼びましょうね。かっこいいし。 だから、6行目は「*hata3」という名前のラベルになるのです。「goto」 命令は、指定したラベルにジャンプするもの、というわけ。<br>									<br>									そして、このラベルを使うとさらに応用が広がるのです。 今度は、新規に次のようなスクリプトを入力してみましょう。<br>									<br>								</p>								<table width="592" border="0" cellspacing="0" cellpadding="0">									<tr>										<td width="45"></td>										<td>											<p><b>cls<br>													mes &quot;ボタンを押してみてね&quot;<br>													button &quot;PUSH&quot;,*hata1<br>													button &quot;BYE&quot;,*hata2<br>														stop</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata1</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>mes&quot;あっ、押しちゃったね&quot;<br>														stop</b></p>										</td>									</tr>									<tr>										<td width="45">											<p><b>*hata2</b></p>										</td>										<td>											<p></p>										</td>									</tr>									<tr>										<td width="45">											<p></p>										</td>										<td>											<p><b>end</b></p>										</td>									</tr>								</table>								<p>stopとendという新しい命令が出てきましたね。 stop命令はその場で実行を停止、 end命令はウィンドウを閉じてプログラムそのものを終了させるためのものです。 goto命令と合わせて、流れを制御するための大切な命令なので覚えておきましょう。</p>								<br>								<img src="images/btn_extention.gif" alt="" height="29" width="29" border="0"><br>								<table width="589" border="0" cellspacing="2" cellpadding="0" bgcolor="#ccffff">									<tr>										<td align="center" bgcolor="#ccffff">											<p>命令(ステートメント)</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>パラメータ</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>意味</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>stop</p>										</td>										<td align="center" bgcolor="white">											<p>なし</p>										</td>										<td align="center" bgcolor="white">											<p>実行を停止する</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>end</p>										</td>										<td align="center" bgcolor="white">											<p>なし</p>										</td>										<td align="center" bgcolor="white">											<p>実行を終了する</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>goto</p>										</td>										<td align="center" bgcolor="white">											<p>ラベル</p>										</td>										<td align="center" bgcolor="white">											<p>指定したラベルにジャンプ</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>button<br>											</p>										</td>										<td align="center" bgcolor="white">											<p>文字列、ラベル<br>											</p>										</td>										<td align="center" bgcolor="white">											<p>ボタンを表示、押された時に指定したラベルにジャンプ</p>										</td>									</tr>								</table>								<br>								<p>そうしたらさっそく実行してみましょう。 いよいよ今度は、ボタンが登場してきましたね。「PUSH」と書いてある ボタンをクリックすると、「あっ、押しちゃったね」というメッセージ が出てくるはずです。そして、「BYE」というボタンをクリックすると ウインドゥが閉じて終了してしまいます。<br>									<br>									ここで初めて出てきた「button」命令は次にような機能を持っています。<br>									<br>									<img src="images/btn_extention.gif"></p>								<div class="enroll">									<ol>										<li>押しボタンを表示する																				<li>ボタンに指定した文字を表示する																				<li>ボタンが押された時に、指定したラベルにジャンプさせる																		</ol>								</div>								<p><br>									この「button」命令は、いままでの命令と違いパラメータを2つ持って います。3行目の場合だと、「&quot;PUSH&quot;」という部分と、「*hata1」とい う部分です。このように命令に付属するパラメータが複数の場合もこれ からどんどん出てきます。その時は、 パラメータとパラメータの間には 「,(カンマ)」を入れるのが約束です。だから、<br>									<br>								</p>								<table border="0" cellspacing="0" cellpadding="0">									<tr>										<td align="center" width="40">											<p>button</p>										</td>										<td align="center" width="80">											<p>&quot;PUSH&quot;<b>,</b></p>										</td>										<td align="center" width="80">											<p>*hata1</p>										</td>									</tr>									<tr>										<td align="center" width="40">											<p>｜</p>										</td>										<td align="center" width="80">											<p>｜</p>										</td>										<td align="center" width="80">											<p>｜</p>										</td>									</tr>									<tr>										<td align="center" width="40">											<p>命令</p>										</td>										<td align="center" width="80">											<p>パラメータ1</p>										</td>										<td align="center" width="80">											<p>パラメータ2</p>										</td>									</tr>								</table>								<br>								<p>という区切りになります。「button」命令は、パラメータ１にボタンに 表示する文字列、パラメータ２に押された時にジャンプするラベルを指 定します。<br>									<br>									「BYE」というボタンを押した時はどうなっているでしょうか。 「*hata2」というラベルにジャンプするようになっていて、その先には 「end」命令があります。この命令はとってもカンタン。その名の通り、 スクリプトが終わってしまう命令です。「end」命令を実行した時点で ウインドゥを閉じてアプリケーションそのものが終了します。alt+F4や 「閉じる」のメニューを選択した時と同じことになります。<br>									<br>									さて、これでさらに応用範囲が広がりますよね。ボタンを押すことで、 別の画像を表示したり、別なメッセージが表示されたりと、だいぶ可能 性が出てきました。ここでちょっとおさらいをして、ちゃんと覚えたら 次に進みましょう。</p>							</div>							<div class="section">								<table>									<tr>										<td><a href="START-6.HTM"><img src="images/btn_next.gif" alt="" height="29" width="29" border="0"></a></td>										<td><font size="-1"><a href="START-6.HTM">step6：これがランチャー？！</a></font></td>									</tr>								</table>							</div>						</div>					</td>				</tr>			</table>															<div align="center">			<table width="800" border="0" cellspacing="0" cellpadding="0">					<tr>					<td align="center">							<p style="color:#333333; font-size:10px; margin:5px 0px">ONION software Copyright 1997-2009(c) All rights reserved.<br>							</p>						</td>				</tr>				</table>		</div></div>	</body></html>