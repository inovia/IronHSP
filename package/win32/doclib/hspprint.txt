------------------------------------------------------------------------------
HSPDB ver3.4  REFERENCE MANUAL                      HSP : Hot Soup Processor  
ＨＳＰ拡張DLLリファレンス             copyright 2004-2014 (c) onion software  
------------------------------------------------------------------------------

・はじめに

	hspprintは、Hot Soup Processor ver3以降とともに使用することで、Windowsに
	接続されたプリンターデバイス上で画像印刷を可能にするためのプラグインです。
	この拡張DLLを使用することにより、印刷に関する新規命令が追加されます。
	hspprint.dllを使用するためには、Windows2000以降のシステム及び、有効な
	ドライバーがインストールされたプリンタデバイス(ローカルまたはネットワーク)
	が必要になります。
	hspprintは、指定された画像を印刷するためのシンプルなプラグインです。
	任意フォントを使った文字の印刷、ベクターデータの印刷には対応していません。
	プラグインの機能についてご確認の上、ご利用ください。


・使用方法の概要

	拡張プラグインのファイル、hspprint.dllは、HSP3.EXEなど実行ファイルのある
	ディレクトリと同じ場所に置いてください。
	hspprintを使用する場合は、スクリプトの先頭に必ず「#include "hspprint.as"」という
	行を追加してください。以上で、HSPの機能が拡張され、このリファレンスで説明を
	している命令を使用することができるようになります。
	まず最初に、試しに付属のサンプルスクリプト(sample/hspprint/test??.as)を
	実行してみてください。拡張された機能の簡単な使用例を見ることができるはずです。


・更新履歴

	2014/1/11 ver1.0

		最初のバージョン。


・注意点

	hspprint.dllは、HSP3.EXEと同時に使用されるプラグインファイル(DLL)です。
	EXEファイルを作成した場合でも、hspprint.dllをEXEファイルと同じディレクトリ
	に置かないと動作しません。また、packfileにDLLを追加することはできません。


・著作権および連絡先

	ユーザーがHSPを使って作成したオリジナルのソフトウェア(実行ファイル)の
	権利は、それを作成したユーザーに属します。
	有償・無償を問わずhspprint.dllを自由に配布することができ、onion softwareの
	著作権表示義務もありません。
	ユーザーが作成したオリジナルのソフトウェアに対してonion softwareが著作権を
	主張することはありません。

	hspprintプラグインは、onion softwareの著作物です。
	onion softwareは本プログラムによって生じた、いかなる損害についても
	保証いたしません。自己の責任の範囲で使用してください。
	hspprint.dllは、Microsoft Visual C++でコンパイルされて います。 


・命令一覧

	prnflags flag					プリンタ列挙フラグを設定する
	enumprn 変数					プリンタを列挙する
	propprn 変数1,変数2,id,type			プリンタ情報の取得
	execprn id,x,y,sx,sy,bx,by,bsx,bsy,"name"	プリンタ印刷の開始
	getdefprn 変数					規定のプリンタを取得する
	prndialog id					プリンタの設定ダイアログを開く


・命令詳細


	prnflags flag					プリンタ列挙フラグを設定する

		flag = プリンタ列挙フラグ

		hspprintプラグインが列挙するプリンタ一覧の取得フラグを設定します。
		flagに指定された値が取得フラグとなります。
		以下のフラグを指定可能です。(複数を組み合わせることが可能です)

		定義名                       内容
		----------------------------------------------
		PRINTER_ENUM_LOCAL           ローカルプリンタ
		PRINTER_ENUM_CONNECTIONS     接続を確立しているプリンタ
		PRINTER_ENUM_SHARED          共有属性が有効なプリンタ

		flagの値が0かまたは省略された場合は、デフォルトの設定
		(PRINTER_ENUM_LOCAL+PRINTER_ENUM_CONNECTIONS)が使用されます。


	enumprn 変数					プリンタを列挙する

		変数 = 結果の文字列が代入される変数名

		接続されているプリンタ名の一覧を文字列として取得します。
		複数のプリンタが認識されている場合は、複数行文字列が代入されます。
		命令実行後に代入されたプリンタの数が、システム変数statに代入されます。
		enumprn命令で取得された一覧の１行目から順番にプリンタID0、プリンタID1…と
		ID番号が対応することになります。


	propprn 変数1,変数2,id,type			プリンタ情報の取得

		変数1 = 結果Xの値が代入される変数名
		変数2 = 結果Yの値が代入される変数名
		id = プリンタID(0〜)
		type = 取得される情報タイプ

		プリンタに関する情報を取得し、変数1,変数2に代入します。
		idでプリンタIDを指定します。プリンタIDは、enumprn命令で取得された
		一覧の中から順番に0,1,2…の数値で示したものになります。

		代入される情報は、type(情報タイプ)で指定された内容になります。
		情報タイプは以下の中から選択します。

		情報タイプ    内容
		----------------------------------------------
		   0          ビクセル単位のページ解像度X,Y
		   1          ページの物理サイズX,Y(デバイス単位)
		   2          印刷可能領域までの距離X,Y(デバイス単位)
		   3          物理的なページのサイズX,Y(mm単位)

		X,Yの値が代入される場合は、変数は整数型に設定されます。


	execprn id,x,y,sx,sy,bx,by,bsx,bsy,"name"	プリンタ印刷の開始

		id = プリンタID(0〜)
		x,y = 印刷ページ内の画像位置X,Y座標
		sx,sy = 印刷ページ内の画像サイズX,Y
		bx,by = 印刷される画像の左上X,Y座標
		bsx,bsy = 印刷される画像サイズX,Y
		"name" = ドキュメント名

		現在の操作先ウインドウの画像をプリンタで印刷します。
		idでプリンタIDを指定します。プリンタIDは、enumprn命令で取得された
		一覧の中から順番に0,1,2…の数値で示したものになります。

		HSPの画像バッファ内の座標(bx,by)から(bsx,bsy)で指定されたサイズが
		印刷の対象となります。bx,byが省略された場合は、それぞれ0が使用されます。
		bsx,bsyが省略された場合は、最大の画面サイズが使用されます。

		印刷されるページ内での位置を(x,y)で指定することができます。
		これは、ピクセル単位でページ解像度の範囲内に指定可能です。
		またその場合のサイズを(sx,sy)で指定することができます。

		"name"は印刷キューなどに表示されるドキュメント名になります。
		"name"を省略した場合は、"hspdoc"が使用されます。


	getdefprn 変数					規定のプリンタを取得する

		変数 = 結果の文字列が代入される変数名

		規定(デフォルト)のプリンタ名を取得して変数に代入します。


	prndialog id					プリンタの設定ダイアログを開く

		id = プリンタID(0〜)

		プリンタの設定ダイアログを開きます。
		idでプリンタIDを指定します。プリンタIDは、enumprn命令で取得された
		一覧の中から順番に0,1,2…の数値で示したものになります。


-------------------------------------------------------------------------------
                                                HSP users manual / end of file 
-------------------------------------------------------------------------------
