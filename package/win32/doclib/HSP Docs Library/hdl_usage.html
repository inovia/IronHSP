<!doctype html>
<meta charset="utf-8">

<link rel="StyleSheet" type="text/css" href="spn.css">

<title>HSP Docs Library の使い方、ドキュメントの書き方</title>

<h1>HSP Docs Library の使い方、ドキュメントの書き方</h1>

<p><img src='hdl_360_2.png'></p>

<p>HSP Docs Library (HDL) は、HSP のドキュメントをまとめて 検索・閲覧 するためのブラウザです。</p>

<p>hs ヘルプファイル、txt/HTML ドキュメント、サンプルスクリプトを一括して検索したり、相互参照したりすることができます。</p>

<h2>HSP Docs Library が読み込むファイル</h2>

<p>ライブラリのファイルは、次のディレクトリから検索されます。</p>

<table>
<tr><th>ディレクトリ<th>検索されるファイル</tr>
<tr><td>doclib<td>*.hs *.txt *.htm *.html *.hsp</tr>
<tr><td>hsphelp<td>*.hs</tr>
<tr><td>sample<td>*.hsp</tr>
<tr style='color:#777;'><td>common<td>*.as *.hsp (ドキュメント付けされたヘッダファイル)</tr>
</table>

<p>HDL のライブラリに新たなドキュメントを追加する場合は、ファイルを doclib ディレクトリに配置してください。</p>

<p>プラグインやモジュールごとに、doclib ディレクトリ下にカテゴリ ディレクトリを作成し、
その中に関連ドキュメント (hs, hsp サンプル, txt, HTML 文書やそれで使われる画像、スタイルシートなど) をまとめると、
ファイル数が多くなっても管理しやすくなります。
</p>

<p>ドキュメントの文字コードは、<b>Shift_JIS</b> と <b>UTF-8</b> がサポートされています。このドキュメントは、UTF-8 で保存されています。</p>

<h2>HSP Docs Library のドキュメント セクション</h2>

<p>HDL では、読み込まれたファイルの集合を ライブラリ と呼びます。ライブラリは <b>コマンドヘルプ</b>, <b>ドキュメント</b>, <b>サンプル</b>
 という 3 つの セクション に分かれます。
それぞれのセクションは、さらに カテゴリ に細分化されます。カテゴリの下に、コンテンツ本体である ページ があります。

<p>.hs ヘルプファイルの内容は、<b>コマンドヘルプ</b> セクションに振り分けられます。コマンドヘルプセクション内のカテゴリは、使用プラグインごとに分けられます。
</p>

<p>.txt .htm .html ファイルは、<b>ドキュメント</b> セクションに振り分けられます。</p>

<p>.hsp ファイルは、<b>サンプル</b> セクションに振り分けられます。
ドキュメントセクションとサンプルセクション内のカテゴリは、実際にファイルが置かれているディレクトリ名で分けられます。サブディレクトリに属していないファイルは、「デフォルト」カテゴリに区分されます。
</p>

<p style='color:#777;'>common ディレクトリにドキュメント付けされたヘッダファイル (.as .hsp) がある場合は、その内容はコマンドヘルプセクションに区分されます。

<h2>hs ファイルの作成方法</h2>

<p>HDL は、コマンドヘルプマニュアル用のヘルプファイルとして、HSP 独自の hs 形式のヘルプファイルをサポートしています。

<p>hs ファイルの書式については、<a href="HS_BIBLE.txt">HS_BIBLE.txt</a> を参照してください。

<h3>hs ファイルのインライン HTML</h3>

<p>HDL には、hs ファイルの %inst フィールド内で "html{" と書いた行から "}html" と書いた行までの間を、ダイレクトに
 HTML として表示する「インライン HTML」という機能があります。

<p>これは hs ファイルとしての仕様ではなく HDL の表示上の仕様で、hs ファイルで HTML の表現を一部利用することができます。

<pre class="script">
; hs ファイル書式例

%index
stickf
キー入力情報取得

%inst
stickf 関数は、以下のような複数のキーの状態の OR 値を返します。
<span class="hshtm">html{
&lt;table border=1&gt;
&lt;tr&gt;&lt;th&gt;値&lt;/th&gt;&lt;th&gt;キー&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;カーソルキー左(←)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;&lt;td&gt;カーソルキー上(↑)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;4&lt;/td&gt;&lt;td&gt;カーソルキー右(→)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;8&lt;/td&gt;&lt;td&gt;カーソルキー下(↓)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;16&lt;/td&gt;&lt;td&gt;スペースキー&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;Enterキー&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;64&lt;/td&gt;&lt;td&gt;Ctrlキー&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;128&lt;/td&gt;&lt;td&gt;ESCキー&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
}html</span>
</pre>

<p>インライン HTML の区間について、中の HTML の書式は HDL によってチェックされません。
誤った HTML が記述されているとページ全体のレイアウトが崩れたりする可能性もありますので、hs データの配布などを行う場合は十分にチェックを行ってください。
また、情報の意味づけに関係しない、装飾的な目的での HTML の使用は避けるようにしてください。

<p>インライン HTML ではアクティブスクリプト (javascript 等) の記述を行わないでください。
スクリプトの実行に関するいくつかのキーワードは、使用を制限されています。インライン HTML で使用した要素のスタイルは、外部 CSS の影響を受ける場合があります。

<p>HDL の出力ページのドキュメントタイプは、<b>HTML 5</b> です。

<aside>
<h3>(複雑なため推奨しません) ヘッダファイルと hs ドキュメンテーションコメント</h3>

<p>HDL は、common ディレクトリ下のヘッダファイル (.as .hsp) を、<b>ドキュメント付けされたヘッダファイル</b>として読み込みます。

<p>ドキュメント付けされたヘッダファイルとは、ヘッダファイルに hs 形式の<b>ドキュメンテーションコメント</b>を追加した形式のファイルで、
ヘッダファイルとしての機能とコマンドヘルプマニュアルとしての機能をあわせ持ったファイルをさします。

<p>HSP スクリプト中にドキュメンテーションコメントを記入する場合、下記のような書式を使用します。
このスクリプトは、HSP スクリプトとしても hs ヘルプファイルとしてもその仕様を満たし、どちらの形式としても正しく処理されます。

<pre class="script">
;============================================================
; ドキュメンテーションコメントつきヘッダファイル
;============================================================
<span>/* ～ モジュール情報 (hs デフォルトレコード)
%dll
dxmodule

%ver
1.67

%date
2008/05/01

%*/</span> ; <--- これ以降は hs ファイルとしてはコメントになる
;------------------------------------------------------------

#module

;===========================================================
<span>/* ～ ドキュメント部分
%index
dxsetcam
カメラ位置設定

%prm
x1, y1, z1, x2, y2, z2

%inst
カメラの座標 x1, y1, z1 と向き (ターゲット位置 x2, y2, z2) 設定します。

%group
3D 制御命令

%*/</span>
;------------------------------------------------------------
; ～ 実装部分
#deffunc dxsetcam double p1, double p2, double p3, double p4, double p5, double p6
	//
	return
//
#global
</pre>

<p>ドキュメンテーションコメントは、HSP スクリプトの複数行コメント (/* ～ */) 内に、hs ヘルプファイルの書式仕様にしたがって記述します。
この、hs 形式のフィールドタグを含む複数行コメントを、<b>ドキュメントブロック</b>と呼びます。

<p>ドキュメントブロックの終了部分は、% 記号を使って、以降が hs 形式としてコメントとなるように処理します。
hs 形式では、定義されていないフィールドタグがあると、以降の行はコメントとみなされます。
この処理を忘れると、HSP スクリプト部分まで hs ドキュメントの一部として認識されてしまう可能性があります。

<p>この部分の記述は、下記のいずれかの書き方を推奨します。

<pre class="script">
<span>%*/</span>
</pre>

<pre class="script">
<span>%rem
*/</span>
</pre>

<p>ドキュメントブロックの中では、ドキュメントとして複数行コメント (/* ～ */) を表現することはできません。

<p>このルールに従って書かれたファイルは、拡張子を .hs に変更するだけで、
ドキュメンテーションコメントをサポートしない hs ヘルプツールからも読み込むことが出来ます。
</aside>

<aside>
<h2>ドキュメントのサムネイル画像 (HDL 1.40 で廃止されました)</h2>

<p>ドキュメントのサムネイル画像表示機能は、複雑であまり利用されなかったため廃止されました。</p>
</aside>

<h2>ドキュメント作成者へのお願い</h2>

<p>ドキュメントやサンプルスクリプト作成の際には、下記の点に留意いただけますと、視認性、検索性が向上します。</p>

<h3>HTML ドキュメントに適切なタイトルを付ける</h3>

<p>HTML ファイルの title タグの内容は、ドキュメントのタイトルとして認識されます。
タイトルは、ドキュメントの中身が何であるか分かりやすいものにしてください。</p>

<h3>テキストやサンプルスクリプトにはわかりやすいファイル名を付ける</h3>

<p>サンプルスクリプトや txt ファイルは、ファイル名がそのタイトルとなります。
"test1.hsp" のようなファイル名は、中身が何であるか推測できないため、避けるべきです。</p>

<p>これは、サンプルやドキュメントのディレクトリ名 (= カテゴリ名) にも言えます。</p>

<h3>hs ファイルの改行はビューアーの自動折り返しに任せる</h3>

<p>hs ファイルの本文を固定字数で改行すると、
ビューアーのウィンドウサイズやフォントサイズによっては読みづらくなる場合があります。
パラグラフの折り返しは、ビューアーのウィンドウ幅に任せるようにしてください。
</p>

<h3>HTML ドキュメントの横幅を固定指定しない</h3>

<p>HTML ドキュメントの横幅は絶対値に固定しないで、ブラウザのウィンドウ幅を小さくしていても読めるようにしてください。
</p>

<aside>

<h2>(参考) 命令コマンドヘルプの基本形</h2>

<p>命令コマンドヘルプの解説文について、次の段落スタイルのものが、文章が簡潔になり分かりやすい傾向にあるようです。</p>

<p>段落 ・ この命令は○○○をするものです。(機能の説明)<br>
<br>
段落 ・ p1 で、○○○を指定します。この値は．．．(引数の説明)<br>
<br>
段落 ・ p2 で、○○○を指定します。この値は．．．(引数の説明)<br>
<br>
段落 ・ この命令で注意すべき点は、．．．(注意事項、制限事項の説明)<br>
<br>
段落 ・ この命令が成功すると、システム変数 stat に．．．(戻り値の説明)<br>
</p>

<h3>悪い例</h3>

<p><b>dxsetlocal</b></p>

<p>この命令は、px～pz, m00～m22 で指定された座標変換マトリクスを、dxsetcam 以外の
すべての dxmodule 命令に適用されるローカル座標系として設定します。</p>

<p>…× 文の構造が複雑</p>

<h3>マシな例</h3>

<p><b>dxsetlocal</b></p>

<p>ローカル座標系を設定します。<br>
<br>
px～pz, m00～m22 で、座標変換マトリクスを指定します。<br>
<br>
ローカル座標系は、dxsetcam 以外のすべての dxmodule 命令に適用されます。<br>
</p>

<p>…○ 簡単</p>

</aside>

<h2>アップデート情報</h2>

<p>HDL の最新バージョンは、s.programe net <a href="http://spn.php.xdomain.jp/">http://spn.php.xdomain.jp/</a> で公開されています。

<footer>HSP Docs Library - <a href="http://spn.php.xdomain.jp/">s.programs</a></footer>
